<% if Rails.env.development? %>
  <div class="developer-tools no-print fixed bottom-4 right-4 bg-warm-white border-3 border-dark rounded-2xl shadow-2xl p-6 z-50 max-w-sm" data-controller="dev-tools">
    <div class="flex items-center justify-between mb-4">
      <h4 class="text-lg font-black text-dark">üõ†Ô∏è Dev Tools</h4>
      <button data-action="click->dev-tools#toggle" class="text-lg text-dark hover:text-coral font-bold px-2 py-1 rounded hover:bg-cream transition-all">
        <span data-dev-tools-target="toggle">‚àí</span>
      </button>
    </div>
    
    <div data-dev-tools-target="content" class="space-y-4">
      <!-- Fill current category with random values -->
      <% if defined?(@category) && @category.present? %>
        <%= form_with url: "/cuestionario/dev/fill_random_current", method: :post, local: true, class: "w-full" do |form| %>
          <%= hidden_field_tag :category_id, @category.identifier %>
          <%= form.submit "üé≤ Llenar #{@category.name}", 
              class: "dev-btn-coral block w-full text-left px-4 py-3 text-sm rounded-xl cursor-pointer transition-all duration-200 font-black shadow-md" %>
        <% end %>
      <% end %>

      <!-- Fill all questions with random values -->
      <%= form_with url: "/cuestionario/dev/fill_random", method: :post, local: true, class: "w-full" do |form| %>
        <%= form.submit "üéØ Llenar Todo Aleatorio", 
            class: "dev-btn-green block w-full text-left px-4 py-3 text-sm rounded-xl cursor-pointer transition-all duration-200 font-black shadow-md" %>
      <% end %>

      <!-- Clear session -->
      <%= form_with url: "/cuestionario/dev/clear", method: :delete, local: true, class: "w-full" do |form| %>
        <%= form.submit "üóëÔ∏è Limpiar Sesi√≥n", 
            class: "dev-btn-yellow block w-full text-left px-4 py-3 text-sm rounded-xl cursor-pointer transition-all duration-200 font-black shadow-md" %>
      <% end %>

      <!-- Show results (fills missing with random) -->
      <%= link_to "/cuestionario/dev/show_results", 
          class: "dev-btn-blue block w-full text-center px-4 py-3 text-sm rounded-xl transition-all duration-200 font-black shadow-md" do %>
        üìä Ver Resultados
      <% end %>

      <!-- Session info -->
      <div class="text-sm text-dark mt-5 pt-4 border-t-2 border-cream bg-cream bg-opacity-50 rounded-lg p-3">
        <% answers_count = (session[:questionnaire_answers] || {}).count %>
        <% total_questions = Question.count %>
        <% categories_count = Category.count %>
        <div class="font-semibold mb-1">üìù Respuestas: <%= answers_count %>/<%= total_questions %></div>
        <div class="font-semibold mb-1">üìÇ <%= categories_count %> categor√≠as</div>
        <% if defined?(@category) && @category.present? %>
          <div class="font-semibold">üìç <%= @category.name %></div>
        <% end %>
      </div>
    </div>
  </div>

  <style nonce="<%= content_security_policy_nonce %>">
    .developer-tools {
      font-family: 'Simonetta', serif;
      backdrop-filter: blur(8px);
    }
    
    .developer-tools input[type="submit"],
    .developer-tools a {
      border: none;
      text-decoration: none;
    }
    
    .developer-tools input[type="submit"]:hover,
    .developer-tools a:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
    }

    /* Developer Tools Button Colors - Higher Contrast */
    .dev-btn-coral {
      background: linear-gradient(135deg, #fee2e2, #fecaca);
      border: 3px solid #dc2626;
      color: #991b1b;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }
    
    .dev-btn-coral:hover {
      background: linear-gradient(135deg, #fecaca, #fca5a5);
      border-color: #991b1b;
      color: #7f1d1d;
      box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
    }
    
    .dev-btn-green {
      background: linear-gradient(135deg, #dcfce7, #bbf7d0);
      border: 3px solid #16a34a;
      color: #14532d;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }
    
    .dev-btn-green:hover {
      background: linear-gradient(135deg, #bbf7d0, #86efac);
      border-color: #15803d;
      color: #052e16;
      box-shadow: 0 8px 25px rgba(22, 163, 74, 0.3);
    }
    
    .dev-btn-yellow {
      background: linear-gradient(135deg, #fefce8, #fef3c7);
      border: 3px solid #d97706;
      color: #92400e;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }
    
    .dev-btn-yellow:hover {
      background: linear-gradient(135deg, #fef3c7, #fed7aa);
      border-color: #b45309;
      color: #78350f;
      box-shadow: 0 8px 25px rgba(217, 119, 6, 0.3);
    }
    
    .dev-btn-blue {
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      border: 3px solid #2563eb;
      color: #1e3a8a;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }
    
    .dev-btn-blue:hover {
      background: linear-gradient(135deg, #bfdbfe, #93c5fd);
      border-color: #1d4ed8;
      color: #1e40af;
      box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
    }

    /* Enhanced container styling */
    .developer-tools {
      border: 3px solid #2d3748;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
    }
  </style>
<% end %>