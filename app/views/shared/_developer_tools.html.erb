<% if Rails.env.development? %>
  <div class="developer-tools fixed bottom-4 right-4 bg-warm-white border-2 border-cream rounded-xl shadow-xl p-4 z-50 max-w-xs">
    <div class="flex items-center justify-between mb-3">
      <h4 class="text-sm font-bold text-dark">🛠️ Dev Tools</h4>
      <button onclick="toggleDevTools()" class="text-xs text-medium hover:text-dark">
        <span id="dev-toggle">−</span>
      </button>
    </div>
    
    <div id="dev-tools-content" class="space-y-2">
      <!-- Fill current category with random values -->
      <% if defined?(@category) && @category.present? %>
        <%= form_with url: "/cuestionario/dev/fill_random_current", method: :post, local: true, class: "w-full" do |form| %>
          <%= hidden_field_tag :category_id, @category.identifier %>
          <%= form.submit "🎲 Llenar #{@category.name}", 
              class: "block w-full text-left px-3 py-2 text-xs bg-coral-light hover:bg-coral text-white rounded-lg cursor-pointer transition-colors duration-200 font-medium" %>
        <% end %>
      <% end %>

      <!-- Fill all questions with random values -->
      <%= form_with url: "/cuestionario/dev/fill_random", method: :post, local: true, class: "w-full" do |form| %>
        <%= form.submit "🎯 Llenar Todo Aleatorio", 
            class: "block w-full text-left px-3 py-2 text-xs bg-green-light hover:bg-green text-white rounded-lg cursor-pointer transition-colors duration-200 font-medium" %>
      <% end %>

      <!-- Clear session -->
      <%= form_with url: "/cuestionario/dev/clear", method: :delete, local: true, class: "w-full" do |form| %>
        <%= form.submit "🗑️ Limpiar Sesión", 
            class: "block w-full text-left px-3 py-2 text-xs bg-yellow-400 hover:bg-yellow-500 text-gray-800 rounded-lg cursor-pointer transition-colors duration-200 font-medium" %>
      <% end %>

      <!-- Show results (fills missing with random) -->
      <%= link_to "/cuestionario/dev/show_results", 
          class: "block w-full text-center px-3 py-2 text-xs bg-blue-400 hover:bg-blue-500 text-white rounded-lg transition-colors duration-200 font-medium" do %>
        📊 Ver Resultados
      <% end %>

      <!-- Session info -->
      <div class="text-xs text-medium mt-3 pt-3 border-t border-cream">
        <% answers_count = (session[:questionnaire_answers] || {}).count %>
        <% total_questions = Question.count %>
        <% categories_count = Category.count %>
        <div>📝 Respuestas: <%= answers_count %>/<%= total_questions %></div>
        <div>📂 <%= categories_count %> categorías</div>
        <% if defined?(@category) && @category.present? %>
          <div>📍 <%= @category.name %></div>
        <% end %>
      </div>
    </div>
  </div>

  <script>
    function toggleDevTools() {
      const content = document.getElementById('dev-tools-content');
      const toggle = document.getElementById('dev-toggle');
      
      if (content.style.display === 'none') {
        content.style.display = 'block';
        toggle.textContent = '−';
      } else {
        content.style.display = 'none';
        toggle.textContent = '+';
      }
    }
  </script>

  <style>
    .developer-tools {
      font-family: 'Simonetta', serif;
    }
    
    .developer-tools input[type="submit"],
    .developer-tools a {
      border: none;
      text-decoration: none;
    }
    
    .developer-tools input[type="submit"]:hover,
    .developer-tools a:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
  </style>
<% end %>