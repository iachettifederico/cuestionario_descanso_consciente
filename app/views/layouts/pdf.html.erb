<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Resultados - Cuestionario de Descanso Consciente</title>
  
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  
  <link href="https://fonts.googleapis.com/css2?family=Simonetta:wght@400;700&display=swap" rel="stylesheet">
  <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body class="pdf-body">
  <%= yield %>
  
  <script>
    document.getElementById('download-pdf-btn')?.addEventListener('click', function() {
      const element = document.querySelector('.bg-gradient-cream');
      const opt = {
        margin: 10,
        filename: 'resultados_descanso_consciente.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      
      this.textContent = '⏳ Generando PDF...';
      this.disabled = true;
      
      html2pdf().set(opt).from(element).save().then(() => {
        this.textContent = '📄 Descargar PDF';
        this.disabled = false;
      });
    });
  </script>
</body>
</html>
